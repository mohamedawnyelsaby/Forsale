// ========================================
// FORSALE - INTERNATIONALIZATION (i18n)
// Multi-language support for global marketplace
// ========================================

const translations = {
  // ============ ENGLISH (Primary) ============
  en: {
    // Authentication
    welcome_back: "Welcome Back",
    email_address: "Email address",
    password: "Password",
    sign_in: "Sign In",
    sign_up: "Sign Up",
    dont_have_account: "Don't have an account?",
    quick_login_biometrics: "Quick Login with Biometrics",
    continue_with_pi: "Continue with Pi Network",
    
    // Navigation
    home: "Home",
    ai_search: "AI Search",
    orders: "Orders",
    wallet: "Wallet",
    categories: "Categories",
    
    // Search
    search_placeholder: "Search with AI or describe your dream product...",
    voice_search: "Voice Search",
    image_search: "Image Search",
    
    // Products
    hot_deals: "Hot Deals",
    limited_time: "Limited time offers",
    ai_picks: "AI Picks for You",
    personalized: "Personalized recommendations",
    see_all: "See All",
    buy_now: "Buy Now",
    quick_buy: "Buy",
    
    // Product Details
    product_details: "Product Details",
    ai_price_intelligence: "AI Price Intelligence",
    deal_score: "Deal Score",
    market_avg: "Market Avg",
    description: "Description",
    seller_info: "Seller Information",
    verified_seller: "Verified Seller",
    message_seller: "Message Seller",
    sales: "sales",
    
    // Checkout
    checkout: "Checkout",
    order_summary: "Order Summary",
    buyer_protection: "Buyer Protection",
    secure_escrow: "Money held securely in escrow",
    pay: "Pay",
    
    // Settings
    settings: "Settings",
    account: "Account",
    notifications: "Notifications",
    language: "Language",
    
    // Common
    cancel: "Cancel",
    confirm: "Confirm",
    loading: "Loading...",
    error: "Error",
    success: "Success"
  },
  
  // ============ ARABIC ============
  ar: {
    welcome_back: "مرحباً بعودتك",
    email_address: "البريد الإلكتروني",
    password: "كلمة المرور",
    sign_in: "تسجيل الدخول",
    sign_up: "إنشاء حساب",
    dont_have_account: "ليس لديك حساب؟",
    quick_login_biometrics: "تسجيل دخول سريع بالبصمة",
    continue_with_pi: "المتابعة عبر Pi Network",
    
    home: "الرئيسية",
    ai_search: "البحث الذكي",
    orders: "الطلبات",
    wallet: "المحفظة",
    categories: "الفئات",
    
    search_placeholder: "ابحث بالذكاء الاصطناعي أو صف منتج أحلامك...",
    voice_search: "البحث الصوتي",
    image_search: "البحث بالصورة",
    
    hot_deals: "عروض ساخنة",
    limited_time: "عروض لفترة محدودة",
    ai_picks: "اختيارات الذكاء الاصطناعي لك",
    personalized: "توصيات شخصية",
    see_all: "عرض الكل",
    buy_now: "اشترِ الآن",
    quick_buy: "شراء",
    
    product_details: "تفاصيل المنتج",
    ai_price_intelligence: "تحليل الأسعار بالذكاء الاصطناعي",
    deal_score: "تقييم العرض",
    market_avg: "متوسط السوق",
    description: "الوصف",
    seller_info: "معلومات البائع",
    verified_seller: "بائع موثق",
    message_seller: "مراسلة البائع",
    sales: "مبيعات",
    
    checkout: "إتمام الشراء",
    order_summary: "ملخص الطلب",
    buyer_protection: "حماية المشتري",
    secure_escrow: "الأموال محفوظة بشكل آمن",
    pay: "ادفع",
    
    settings: "الإعدادات",
    account: "الحساب",
    notifications: "الإشعارات",
    language: "اللغة",
    
    cancel: "إلغاء",
    confirm: "تأكيد",
    loading: "جاري التحميل...",
    error: "خطأ",
    success: "نجح"
  },
  
  // ============ SPANISH ============
  es: {
    welcome_back: "Bienvenido de nuevo",
    email_address: "Correo electrónico",
    password: "Contraseña",
    sign_in: "Iniciar sesión",
    sign_up: "Registrarse",
    dont_have_account: "¿No tienes cuenta?",
    quick_login_biometrics: "Inicio rápido con biometría",
    continue_with_pi: "Continuar con Pi Network",
    
    home: "Inicio",
    ai_search: "Búsqueda IA",
    orders: "Pedidos",
    wallet: "Billetera",
    categories: "Categorías",
    
    search_placeholder: "Buscar con IA o describe tu producto ideal...",
    voice_search: "Búsqueda por voz",
    image_search: "Búsqueda por imagen",
    
    hot_deals: "Ofertas Candentes",
    limited_time: "Ofertas por tiempo limitado",
    ai_picks: "Selecciones IA para ti",
    personalized: "Recomendaciones personalizadas",
    see_all: "Ver todo",
    buy_now: "Comprar ahora",
    quick_buy: "Comprar",
    
    product_details: "Detalles del producto",
    ai_price_intelligence: "Inteligencia de Precios IA",
    deal_score: "Puntuación",
    market_avg: "Promedio del mercado",
    description: "Descripción",
    seller_info: "Información del vendedor",
    verified_seller: "Vendedor verificado",
    message_seller: "Mensaje al vendedor",
    sales: "ventas",
    
    checkout: "Pagar",
    order_summary: "Resumen del pedido",
    buyer_protection: "Protección del comprador",
    secure_escrow: "Dinero retenido de forma segura",
    pay: "Pagar",
    
    settings: "Configuración",
    account: "Cuenta",
    notifications: "Notificaciones",
    language: "Idioma",
    
    cancel: "Cancelar",
    confirm: "Confirmar",
    loading: "Cargando...",
    error: "Error",
    success: "Éxito"
  },
  
  // ============ FRENCH ============
  fr: {
    welcome_back: "Bon retour",
    email_address: "Adresse e-mail",
    password: "Mot de passe",
    sign_in: "Se connecter",
    sign_up: "S'inscrire",
    dont_have_account: "Pas de compte ?",
    quick_login_biometrics: "Connexion rapide avec biométrie",
    continue_with_pi: "Continuer avec Pi Network",
    
    home: "Accueil",
    ai_search: "Recherche IA",
    orders: "Commandes",
    wallet: "Portefeuille",
    categories: "Catégories",
    
    search_placeholder: "Rechercher avec l'IA ou décrire votre produit...",
    voice_search: "Recherche vocale",
    image_search: "Recherche par image",
    
    hot_deals: "Offres Chaudes",
    limited_time: "Offres à durée limitée",
    ai_picks: "Sélections IA pour vous",
    personalized: "Recommandations personnalisées",
    see_all: "Voir tout",
    buy_now: "Acheter maintenant",
    quick_buy: "Acheter",
    
    product_details: "Détails du produit",
    ai_price_intelligence: "Intelligence des Prix IA",
    deal_score: "Score de l'offre",
    market_avg: "Moyenne du marché",
    description: "Description",
    seller_info: "Informations vendeur",
    verified_seller: "Vendeur vérifié",
    message_seller: "Message au vendeur",
    sales: "ventes",
    
    checkout: "Paiement",
    order_summary: "Résumé de la commande",
    buyer_protection: "Protection acheteur",
    secure_escrow: "Argent détenu en sécurité",
    pay: "Payer",
    
    settings: "Paramètres",
    account: "Compte",
    notifications: "Notifications",
    language: "Langue",
    
    cancel: "Annuler",
    confirm: "Confirmer",
    loading: "Chargement...",
    error: "Erreur",
    success: "Succès"
  },
  
  // ============ GERMAN ============
  de: {
    welcome_back: "Willkommen zurück",
    email_address: "E-Mail-Adresse",
    password: "Passwort",
    sign_in: "Anmelden",
    sign_up: "Registrieren",
    dont_have_account: "Kein Konto?",
    quick_login_biometrics: "Schnellanmeldung mit Biometrie",
    continue_with_pi: "Mit Pi Network fortfahren",
    
    home: "Startseite",
    ai_search: "KI-Suche",
    orders: "Bestellungen",
    wallet: "Geldbörse",
    categories: "Kategorien",
    
    search_placeholder: "Mit KI suchen oder Ihr Traumprodukt beschreiben...",
    voice_search: "Sprachsuche",
    image_search: "Bildsuche",
    
    hot_deals: "Heiße Angebote",
    limited_time: "Zeitlich begrenzte Angebote",
    ai_picks: "KI-Auswahl für Sie",
    personalized: "Personalisierte Empfehlungen",
    see_all: "Alle anzeigen",
    buy_now: "Jetzt kaufen",
    quick_buy: "Kaufen",
    
    product_details: "Produktdetails",
    ai_price_intelligence: "KI-Preisintelligenz",
    deal_score: "Angebotswert",
    market_avg: "Marktdurchschnitt",
    description: "Beschreibung",
    seller_info: "Verkäuferinformationen",
    verified_seller: "Verifizierter Verkäufer",
    message_seller: "Verkäufer kontaktieren",
    sales: "Verkäufe",
    
    checkout: "Kasse",
    order_summary: "Bestellübersicht",
    buyer_protection: "Käuferschutz",
    secure_escrow: "Geld sicher verwahrt",
    pay: "Bezahlen",
    
    settings: "Einstellungen",
    account: "Konto",
    notifications: "Benachrichtigungen",
    language: "Sprache",
    
    cancel: "Abbrechen",
    confirm: "Bestätigen",
    loading: "Wird geladen...",
    error: "Fehler",
    success: "Erfolg"
  },
  
  // ============ CHINESE (Simplified) ============
  zh: {
    welcome_back: "欢迎回来",
    email_address: "电子邮件地址",
    password: "密码",
    sign_in: "登录",
    sign_up: "注册",
    dont_have_account: "没有账户？",
    quick_login_biometrics: "生物识别快速登录",
    continue_with_pi: "使用 Pi Network 继续",
    
    home: "首页",
    ai_search: "AI搜索",
    orders: "订单",
    wallet: "钱包",
    categories: "分类",
    
    search_placeholder: "使用 AI 搜索或描述您的梦想产品...",
    voice_search: "语音搜索",
    image_search: "图片搜索",
    
    hot_deals: "热门优惠",
    limited_time: "限时优惠",
    ai_picks: "AI 为您推荐",
    personalized: "个性化推荐",
    see_all: "查看全部",
    buy_now: "立即购买",
    quick_buy: "购买",
    
    product_details: "产品详情",
    ai_price_intelligence: "AI 价格智能",
    deal_score: "优惠评分",
    market_avg: "市场平均",
    description: "描述",
    seller_info: "卖家信息",
    verified_seller: "已验证卖家",
    message_seller: "联系卖家",
    sales: "销量",
    
    checkout: "结账",
    order_summary: "订单摘要",
    buyer_protection: "买家保护",
    secure_escrow: "资金安全托管",
    pay: "支付",
    
    settings: "设置",
    account: "账户",
    notifications: "通知",
    language: "语言",
    
    cancel: "取消",
    confirm: "确认",
    loading: "加载中...",
    error: "错误",
    success: "成功"
  },
  
  // ============ HINDI ============
  hi: {
    welcome_back: "वापसी पर स्वागत है",
    email_address: "ईमेल पता",
    password: "पासवर्ड",
    sign_in: "साइन इन करें",
    sign_up: "साइन अप करें",
    dont_have_account: "खाता नहीं है?",
    quick_login_biometrics: "बायोमेट्रिक्स से तेज़ लॉगिन",
    continue_with_pi: "Pi Network से जारी रखें",
    
    home: "होम",
    ai_search: "AI खोज",
    orders: "ऑर्डर",
    wallet: "वॉलेट",
    categories: "श्रेणियां",
    
    search_placeholder: "AI से खोजें या अपने सपनों का उत्पाद वर्णन करें...",
    voice_search: "वॉयस सर्च",
    image_search: "इमेज सर्च",
    
    hot_deals: "हॉट डील्स",
    limited_time: "सीमित समय के ऑफर",
    ai_picks: "आपके लिए AI चयन",
    personalized: "व्यक्तिगत सिफारिशें",
    see_all: "सभी देखें",
    buy_now: "अभी खरीदें",
    quick_buy: "खरीदें",
    
    product_details: "उत्पाद विवरण",
    ai_price_intelligence: "AI मूल्य बुद्धिमत्ता",
    deal_score: "डील स्कोर",
    market_avg: "बाजार औसत",
    description: "विवरण",
    seller_info: "विक्रेता जानकारी",
    verified_seller: "सत्यापित विक्रेता",
    message_seller: "विक्रेता को संदेश",
    sales: "बिक्री",
    
    checkout: "चेकआउट",
    order_summary: "ऑर्डर सारांश",
    buyer_protection: "खरीदार सुरक्षा",
    secure_escrow: "धन सुरक्षित रूप से रखा गया",
    pay: "भुगतान करें",
    
    settings: "सेटिंग्स",
    account: "खाता",
    notifications: "सूचनाएं",
    language: "भाषा",
    
    cancel: "रद्द करें",
    confirm: "पुष्टि करें",
    loading: "लोड हो रहा है...",
    error: "त्रुटि",
    success: "सफलता"
  },
  
  // ============ PORTUGUESE ============
  pt: {
    welcome_back: "Bem-vindo de volta",
    email_address: "Endereço de e-mail",
    password: "Senha",
    sign_in: "Entrar",
    sign_up: "Cadastrar",
    dont_have_account: "Não tem conta?",
    quick_login_biometrics: "Login rápido com biometria",
    continue_with_pi: "Continuar com Pi Network",
    
    home: "Início",
    ai_search: "Busca IA",
    orders: "Pedidos",
    wallet: "Carteira",
    categories: "Categorias",
    
    search_placeholder: "Buscar com IA ou descrever seu produto dos sonhos...",
    voice_search: "Busca por voz",
    image_search: "Busca por imagem",
    
    hot_deals: "Ofertas Quentes",
    limited_time: "Ofertas por tempo limitado",
    ai_picks: "Escolhas IA para você",
    personalized: "Recomendações personalizadas",
    see_all: "Ver tudo",
    buy_now: "Comprar agora",
    quick_buy: "Comprar",
    
    product_details: "Detalhes do produto",
    ai_price_intelligence: "Inteligência de Preços IA",
    deal_score: "Pontuação da oferta",
    market_avg: "Média do mercado",
    description: "Descrição",
    seller_info: "Informações do vendedor",
    verified_seller: "Vendedor verificado",
    message_seller: "Mensagem ao vendedor",
    sales: "vendas",
    
    checkout: "Finalizar",
    order_summary: "Resumo do pedido",
    buyer_protection: "Proteção do comprador",
    secure_escrow: "Dinheiro mantido com segurança",
    pay: "Pagar",
    
    settings: "Configurações",
    account: "Conta",
    notifications: "Notificações",
    language: "Idioma",
    
    cancel: "Cancelar",
    confirm: "Confirmar",
    loading: "Carregando...",
    error: "Erro",
    success: "Sucesso"
  },
  
  // ============ RUSSIAN ============
  ru: {
    welcome_back: "С возвращением",
    email_address: "Адрес электронной почты",
    password: "Пароль",
    sign_in: "Войти",
    sign_up: "Зарегистрироваться",
    dont_have_account: "Нет аккаунта?",
    quick_login_biometrics: "Быстрый вход с биометрией",
    continue_with_pi: "Продолжить с Pi Network",
    
    home: "Главная",
    ai_search: "AI Поиск",
    orders: "Заказы",
    wallet: "Кошелек",
    categories: "Категории",
    
    search_placeholder: "Поиск с AI или опишите продукт мечты...",
    voice_search: "Голосовой поиск",
    image_search: "Поиск по изображению",
    
    hot_deals: "Горячие предложения",
    limited_time: "Ограниченные предложения",
    ai_picks: "AI выбор для вас",
    personalized: "Персональные рекомендации",
    see_all: "Смотреть все",
    buy_now: "Купить сейчас",
    quick_buy: "Купить",
    
    product_details: "Детали продукта",
    ai_price_intelligence: "AI Анализ Цен",
    deal_score: "Оценка предложения",
    market_avg: "Средняя рыночная",
    description: "Описание",
    seller_info: "Информация о продавце",
    verified_seller: "Проверенный продавец",
    message_seller: "Сообщение продавцу",
    sales: "продаж",
    
    checkout: "Оформление",
    order_summary: "Итоги заказа",
    buyer_protection: "Защита покупателя",
    secure_escrow: "Деньги надежно хранятся",
    pay: "Оплатить",
    
    settings: "Настройки",
    account: "Аккаунт",
    notifications: "Уведомления",
    language: "Язык",
    
    cancel: "Отмена",
    confirm: "Подтвердить",
    loading: "Загрузка...",
    error: "Ошибка",
    success: "Успех"
  },
  
  // ============ JAPANESE ============
  ja: {
    welcome_back: "おかえりなさい",
    email_address: "メールアドレス",
    password: "パスワード",
    sign_in: "サインイン",
    sign_up: "登録",
    dont_have_account: "アカウントをお持ちではありませんか？",
    quick_login_biometrics: "生体認証でクイックログイン",
    continue_with_pi: "Pi Networkで続行",
    
    home: "ホーム",
    ai_search: "AI検索",
    orders: "注文",
    wallet: "ウォレット",
    categories: "カテゴリー",
    
    search_placeholder: "AIで検索するか、理想の製品を説明してください...",
    voice_search: "音声検索",
    image_search: "画像検索",
    
    hot_deals: "ホットディール",
    limited_time: "期間限定オファー",
    ai_picks: "AIのおすすめ",
    personalized: "パーソナライズされた推奨",
    see_all: "すべて見る",
    buy_now: "今すぐ購入",
    quick_buy: "購入",
    
    product_details: "商品詳細",
    ai_price_intelligence: "AI価格インテリジェンス",
    deal_score: "取引スコア",
    market_avg: "市場平均",
    description: "説明",
    seller_info: "販売者情報",
    verified_seller: "認証済み販売者",
    message_seller: "販売者にメッセージ",
    sales: "販売",
    
    checkout: "チェックアウト",
    order_summary: "注文概要",
    buyer_protection: "購入者保護",
    secure_escrow: "安全に保管された資金",
    pay: "支払う",
    
    settings: "設定",
    account: "アカウント",
    notifications: "通知",
    language: "言語",
    
    cancel: "キャンセル",
    confirm: "確認",
    loading: "読み込み中...",
    error: "エラー",
    success: "成功"
  }
};

// ============ I18N FUNCTIONS ============

// Current language (default: English)
let currentLanguage = 'en';

// Initialize i18n
function initI18n() {
  // Check saved language preference
  const savedLang = localStorage.getItem('forsale_language') || detectBrowserLanguage();
  changeLanguage(savedLang);
}

// Detect browser language
function detectBrowserLanguage() {
  const browserLang = navigator.language || navigator.userLanguage;
  const langCode = browserLang.split('-')[0]; // Get 'en' from 'en-US'
  
  // Return detected language if supported, otherwise default to English
  return translations[langCode] ? langCode : 'en';
}

// Change language
function changeLanguage(langCode) {
  if (!translations[langCode]) {
    console.warn(`Language ${langCode} not supported, falling back to English`);
    langCode = 'en';
  }
  
  currentLanguage = langCode;
  localStorage.setItem('forsale_language', langCode);
  
  // Update HTML attributes
  document.documentElement.lang = langCode;
  document.documentElement.dir = langCode === 'ar' ? 'rtl' : 'ltr';
  
  // Update all elements with data-i18n attribute
  updatePageTranslations();
  
  // Update language selector
  const selectors = document.querySelectorAll('#language-selector, .language-select');
  selectors.forEach(selector => {
    if (selector) selector.value = langCode;
  });
  
  // Close language menu if open
  const menu = document.getElementById('language-menu');
  if (menu) menu.style.display = 'none';
  
  console.log(`✅ Language changed to: ${langCode}`);
}

// Update all translations on the page
function updatePageTranslations() {
  const elements = document.querySelectorAll('[data-i18n]');
  
  elements.forEach(element => {
    const key = element.getAttribute('data-i18n');
    const translation = translations[currentLanguage][key];
    
    if (translation) {
      // Update element text or placeholder
      if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
        element.placeholder = translation;
      } else {
        element.textContent = translation;
      }
    } else {
      console.warn(`Translation key "${key}" not found for language "${currentLanguage}"`);
    }
  });
}

// Get translation for a key
function t(key) {
  return translations[currentLanguage][key] || translations['en'][key] || key;
}

// Toggle language menu
function toggleLanguageMenu() {
  const menu = document.getElementById('language-menu');
  if (menu) {
    menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
  }
}

// Close language menu when clicking outside
document.addEventListener('click', function(event) {
  const menu = document.getElementById('language-menu');
  const btn = event.target.closest('.language-switcher');
  
  if (menu && !btn && menu.style.display === 'block') {
    menu.style.display = 'none';
  }
});

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initI18n);
} else {
  initI18n();
}

// Export for use in other scripts
window.i18n = {
  changeLanguage,
  t,
  getCurrentLanguage: () => currentLanguage,
  getSupportedLanguages: () => Object.keys(translations),
  toggleLanguageMenu
};

console.log('✅ i18n system loaded - Supporting', Object.keys(translations).length, 'languages');
